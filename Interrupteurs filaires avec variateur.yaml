light:
  - platform: template
    lights:
      nom_de_la_lumière: # Nom de l'entité de cette lumière sur Home Assistant
        friendly_name: # Nom de la lumière" #Nom qui s'affichera pour cette lumière sur l'interface de Home Assistant
        set_level: # Configuration du changement d'intensité de la lumière
          - service: light.turn_on
            data_template:
              entity_id: light.zigate_xxxxxxxxxxxxxx # Remplir avec le nom de l'entité de la lumière créé automatiquerment par le plugin de Doudz pour la Zigate sur Home Assistant
              transition: 1 # Les interrupteurs Legrand with Netatmo nécessitent ce paramètre pour contrôler correctement l'intensité de la lumière (sans ce paramètre, les changements d'intensité demandés ne se font que d'un pourcent à chaque changement d'intensité)
              brightness: "{{ brightness }}"
          - service: zigate.refresh_device # Appel du service pour actualiser les attributs l'interrupteur, afin de bien synchroniser ces attriuts entre ceux de Home Assistant et ceux réellement dans l'interrupteur
            data:
              entity_id: zigate.xxxxxxxxxxxxxx # Remplir avec le nom de l'entité de l'interrupteur (attention PAS celuis de la lumière) créé automatiquement par le plugin de Doudz pour la Zigate sur Home Assistant
        turn_on: # Configuration de l'allumage simple de la lumière
          - service: light.turn_on
            data:
              entity_id: light.zigate_xxxxxxxxxxxxxx # Remplir avec le nom de l'entité de la lumière créé automatiquerment par le plugin de Doudz pour la Zigate sur Home Assistant
          - service: zigate.refresh_device # Appel du service pour actualiser les attributs l'interrupteur, afin de bien synchroniser ces attriuts entre ceux de Home Assistant et ceux réellement dans l'interrupteur
            data:
              entity_id: zigate.xxxxxxxxxxxxxx # Remplir avec le nom de l'entité de l'interrupteur (attention PAS celuis de la lumière) créé automatiquement par le plugin de Doudz pour la Zigate sur Home Assistant
        turn_off: 
          - service: light.turn_off # Configuration de l'extinction de la lumière
            data:
              entity_id: light.zigate_xxxxxxxxxxxxxx # Remplir avec le nom de l'entité de la lumière créé automatiquerment par le plugin de Doudz pour la Zigate sur Home Assistant
          - service: zigate.refresh_device # Appel du service pour actualiser les attributs l'interrupteur, afin de bien synchroniser ces attriuts entre ceux de Home Assistant et ceux réellement dans l'interrupteur
            data:
              entity_id: zigate.xxxxxxxxxxxxxx # Remplir avec le nom de l'entité de l'interrupteur (attention PAS celuis de la lumière) créé automatiquement par le plugin de Doudz pour la Zigate sur Home Assistant
        level_template: "{% if is_state('light.zigate_xxxxxxxxxxxxxx', 'on') %} {% if state_attr('light.zigate_xxxxxxxxxxxxxx', 'brightness') == 0 %} 1 {% else %} {{ state_attr('light.zigate_xxxxxxxxxxxxxx', 'brightness') }} {% endif %} {% else %} 0 {% endif %}" # Permet d'affecter la valeur de l'intensité de la lumière lorsque celle-ci est modifiée directement sur l'interrupteur physiquement (en restant appuyé sur les boutons haut ou bas)
        value_template: "{{ states('light.zigate_00047400009a30af_1') }}" # Permet d'affecter la valeur "on" ou "off lorsque celle-ci est modifiée directement sur l'interrupteur physiquement
